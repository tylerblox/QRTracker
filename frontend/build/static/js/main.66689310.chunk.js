(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{33:function(e,n,t){e.exports=t(53)},38:function(e,n,t){},47:function(e,n,t){},53:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),c=t(18),o=t.n(c),l=(t(38),t(22)),i=t(3),s=t(4),u=t(17),m=t(20),d=t(30),_=t.n(d);function E(){return function(e,n){e({type:"RESET"})}}function f(e){var n=null;if(document.cookie&&""!==document.cookie)for(var t=document.cookie.split(";"),r=0;r<t.length;r++){var a=t[r].trim();if(a.substring(0,e.length+1)===e+"="){n=decodeURIComponent(a.substring(e.length+1));break}}return n}var h=function(){return{type:"QR_SCANNER_START"}},v=function(e){return{type:"QR_SCANNER_ERROR",payload:{error:e}}};var p=function(){return{type:"CONFIRM_CODE_START"}};var S=function(){return{type:"FETCH_EVENTS_START"}},C=function(e){return{type:"FETCH_EVENTS_SUCCESS",payload:{events:e}}},g=function(e){return{type:"FETCH_EVENTS_ERROR",payload:{error:e}}};t(47);var R=t(11),y=t(12),b=function(e){return a.a.createElement("div",{className:"confirm-event-modal"},a.a.createElement("div",{className:"confirm-event-content"},e.error_with_confirmation&&a.a.createElement("p",{className:"error-text"},"Error in confirming event.  Please try again, or ",a.a.createElement("span",{onClick:e.resetScanner},"Scan a new Code")),a.a.createElement("div",{className:"confirm-event-content--topic"},"Confirm this Event"),a.a.createElement("div",{className:"confirm-event-content--event"},a.a.createElement("div",{className:"event-name-display-holder"},a.a.createElement("h1",{className:"confirm-event-content--event--name"},e.most_recent_code.event.name)),a.a.createElement("ul",null,a.a.createElement("li",null,a.a.createElement(R.a,{icon:y.b,size:"2x",style:{width:32}}),a.a.createElement("span",null,e.most_recent_code.event.date)),a.a.createElement("li",null,a.a.createElement(R.a,{icon:y.e,size:"2x",style:{width:32}}),e.most_recent_code.event.location.name)))),a.a.createElement("div",{className:"confirmation-buttons"},a.a.createElement("button",{className:"button--primary",onClick:function(){e.confirmQrCode(!0,{event_promoter:e.most_recent_code.id})}},a.a.createElement(R.a,{icon:y.d,size:"4x"})),a.a.createElement("button",{className:"button--secondary",onClick:function(){e.confirmQrCode(!1,{})}},a.a.createElement(R.a,{icon:y.f,size:"4x"}))))};var N={scanQrCode:function(e){return function(n,t){n(h),fetch("https://"+e).then((function(e){return e.ok||n(v(e)),e.json()})).then((function(e){return n({type:"QR_SCANNER_SUCCESS",payload:{value:e}})})).catch((function(e){return n(v(e))}))}},confirmQrCode:function(e,n){return e?function(e,t){e(p),fetch("https://qr-tickets.herokuapp.com/api/event_register/",{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json","X-CSRFToken":f("csrftoken")},redirect:"follow",body:JSON.stringify(n)}).then((function(e){if(!e.ok)throw new Error("Whoops!");return e.json()})).then((function(n){return e({type:"CONFIRM_CODE_SUCCESS",payload:{value:n}})})).catch((function(n){return e({type:"CONFIRM_CODE_ERROR",payload:{error:n}})}))}:function(e,n){e({type:"RESET"})}},setScannerActive:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function(n,t){var r=e?null:t().qr_scanner.most_recent_code;n({type:"SET_SCANNER_ACTIVE",payload:{scanner_active:e,most_recent_code:r}})}},resetScanner:E},O=Object(m.b)((function(e){return e.qr_scanner}),N)((function(e){var n=a.a.useState({scanMode:!0}),t=Object(u.a)(n,2),r=t[0],c=t[1],o=e.setScannerActive,l=e.most_recent_code;a.a.useEffect((function(){l&&o(!1)}),[l,o]);var i=function(n){n&&e.scanQrCode(n)},m=function(e){console.log("DO SOME THING WITH THIS ERROR"),console.error(e)},d=e.most_recent_code&&e.qr_code_fetched&&!e.qr_code_fetch_error&&!e.confirmed_qr_code,E=a.a.useCallback(function(){switch(console.log(e),!0){case!!e.qr_code_fetch_error:return a.a.createElement("p",null,"There was an error scanning the QR code.. ",e.qr_code_fetch_error);case e.most_recent_code&&e.confirmed_qr_code:return a.a.createElement("h2",{className:"registration-success"},"Successfully registered!");case e.scanner_active:return a.a.createElement(_.a,{className:"qr-scanner",delay:1e3,onError:m,onScan:i});default:return a.a.createElement(a.a.Fragment,null,a.a.createElement("p",null," Begin Scanning Below..."),a.a.createElement("div",{style:{position:"relative",height:"100%"}},a.a.createElement(R.a,{icon:y.a,size:"2x",className:"arrow-moving-down",style:{color:"#FFF",marginLeft:"auto",position:"absolute",marginRight:"auto",left:0,right:0}})))}}(),[e]);return a.a.createElement("div",{className:"App",style:{height:window.innerHeight}},d&&a.a.createElement(b,{most_recent_code:e.most_recent_code,confirmed_qr_code:e.confirmed_qr_code,error_with_confirmation:e.error_with_confirmation,resetScanner:e.resetScanner,confirmQrCode:e.confirmQrCode}),a.a.createElement("button",{onClick:function(){var n=r.scanMode;e.resetScanner(),c(Object(s.a)({},r,{scanMode:!n}))}},r.scanMode?"Switch To Manual Input":"Switch to Scanner Mode"),r.scanMode?a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"qr-content"},E,e.loading&&a.a.createElement("p",null,"Loading...")),d?null:a.a.createElement("button",{className:e.most_recent_code?"scan-again":e.scanner_active?"scan-stop":"scan",onClick:function(){o(!e.scanner_active)}},a.a.createElement(R.a,{icon:y.c,size:"2x"}))):a.a.createElement("p",null," manual entry mode todo: "))})),T={loading:!1,error:null,events:null},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"FETCH_EVENTS_START":return Object(s.a)({},e,{loading:!0,error:null});case"FETCH_EVENTS_SUCCESS":return Object(s.a)({},e,{loading:!1,error:null,events:n.payload.events});case"FETCH_EVENTS_ERROR":return Object(s.a)({},e,{loading:!1,error:n.payload.error});default:return e}};function q(e){var n=Object(r.useReducer)(w,T),t=Object(u.a)(n,2),c=t[0],o=t[1],l=Object(r.useState)(null),i=Object(u.a)(l,2),s=i[0],m=i[1];return Object(r.useEffect)((function(){!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(n){n(S),fetch("https://qr-tickets.herokuapp.com"+"/api/events/".concat(e?"?":"").concat(e),{mode:"cors",cache:"no-cache",credentials:"same-origin",redirect:"follow"}).then((function(e){if(!e.ok)throw new Error("Whoops!");return e.json()})).then((function(e){return n(C(e))})).catch((function(e){return n(g(e))}))}}()(o)}),[]),c.loading?"Loading":c.events?a.a.createElement(a.a.Fragment,null,c.events.map((function(e,n){return a.a.createElement("button",{key:e.id,name:e.name,onClick:function(){return m(e)}},e.name)})),s?a.a.createElement("table",{style:{width:"100%",textAlign:"center"}},a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",null,"Promoter"),a.a.createElement("th",null,"Registration Count"))),a.a.createElement("tbody",null,s.event_promoters.map((function(e){return a.a.createElement("tr",null,a.a.createElement("td",null,e.promoter_name),a.a.createElement("td",null,e.registration_count))})))):null):c.error?"error":null}function j(){var e=Object(i.g)().path;return a.a.createElement(i.d,null,a.a.createElement(i.b,{path:"".concat(e,"/statistics/")},a.a.createElement(q,null)))}var k=function(e){return a.a.createElement(l.a,null,a.a.createElement(i.d,null,a.a.createElement(i.b,{path:"/admin"},a.a.createElement(j,null)),a.a.createElement(i.b,{path:"/"},a.a.createElement(O,null)),a.a.createElement(i.a,{to:"/"})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var A=t(13),F=t(32),I={scanner_active:!0,fetching_qr_code:!1,qr_code_fetch_error:null,most_recent_code:null,qr_code_fetched:!1,confirming_qr_code:!1,error_with_confirmation:null,confirmed_qr_code:!1},M=Object(A.c)({qr_scanner:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"RESET":return Object(s.a)({},e,{},I);case"SET_SCANNER_ACTIVE":return Object(s.a)({},e,{qr_code_fetch_error:null},n.payload);case"QR_SCANNER_START":return Object(s.a)({},e,{fetching_qr_code:!0,scanner_active:!1});case"QR_SCANNER_SUCCESS":return Object(s.a)({},e,{},I,{scanner_active:!1,qr_code_fetched:!0,fetching_qr_code:!1,most_recent_code:n.payload.value});case"QR_SCANNER_ERROR":return Object(s.a)({},e,{scanner_active:!1,qr_code_fetched:!1,fetching_qr_code:!1,qr_code_fetch_error:n.payload.error.message});case"CONFIRM_CODE_START":return Object(s.a)({},e,{confirming_qr_code:!0});case"CONFIRM_CODE_SUCCESS":return Object(s.a)({},e,{scanner_active:!1,confirmed_qr_code:!0});case"CONFIRM_CODE_ERROR":return Object(s.a)({},e,{error_with_confirmation:n.payload.error});default:return e}}}),Q=Object(A.d)(M,Object(A.a)(F.a));o.a.render(a.a.createElement(m.a,{store:Q},a.a.createElement(k,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[33,1,2]]]);
//# sourceMappingURL=main.66689310.chunk.js.map