(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{18:function(e,n,t){e.exports=t(36)},23:function(e,n,t){},33:function(e,n,t){e.exports=t.p+"static/media/logo.5d5d9eef.svg"},34:function(e,n,t){},36:function(e,n,t){"use strict";t.r(n);var r=t(0),c=t.n(r),o=t(7),a=t.n(o),i=(t(23),t(1)),_=t(17),s=t(8),l=t(14),d=t.n(l);function u(){return function(e,n){e({type:"RESET"})}}function m(e){var n=null;if(document.cookie&&""!==document.cookie)for(var t=document.cookie.split(";"),r=0;r<t.length;r++){var c=t[r].trim();if(c.substring(0,e.length+1)===e+"="){n=decodeURIComponent(c.substring(e.length+1));break}}return n}var f=function(){return{type:"QR_SCANNER_START"}};var h=function(){return{type:"CONFIRM_CODE_START"}};t(33),t(34);var E=function(e){return function(e){return e.most_recent_code&&e.qr_code_fetched&&!e.qr_code_fetch_error&&!e.confirmed_qr_code}(e)?c.a.createElement("div",{className:"confirm-event-modal"},c.a.createElement("div",{className:"confirm-event-content"},e.error_with_confirmation&&c.a.createElement("p",null,"Error in confirming event.  Please try again, or ",c.a.createElement("span",{onClick:e.resetScanner},"Scan a new Code")),c.a.createElement("h1",null,"Confirm this Event"),c.a.createElement("ul",null,c.a.createElement("li",null,e.most_recent_code.event.name),c.a.createElement("li",null,e.most_recent_code.event.date),c.a.createElement("li",null,e.most_recent_code.event.location.name))),c.a.createElement("div",{className:"confirmation-buttons"},c.a.createElement("button",{className:"button--primary",onClick:function(){e.confirmQrCode(!0,{event_promoter:e.most_recent_code.id})}},"Yes"),c.a.createElement("button",{className:"button--secondary",onClick:function(){e.confirmQrCode(!1,{})}},"No"))):null};var S={scanQrCode:function(e){return function(n,t){n(f),fetch("https://"+e).then((function(e){if(!e.ok)throw"whoops";return e.json()})).then((function(e){return n({type:"QR_SCANNER_SUCCESS",payload:{value:e}})})).catch((function(e){return n({type:"QR_SCANNER_ERROR",payload:{error:e}})}))}},confirmQrCode:function(e,n){return e?function(e,t){e(h),fetch("https://localhost:8000/api/event_register/",{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json","X-CSRFToken":m("csrftoken")},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(n)}).then((function(e){if(!e.ok)throw"whoops";return e.json()})).then((function(n){return e({type:"CONFIRM_CODE_SUCCESS",payload:{value:n}})})).catch((function(n){return e({type:"CONFIRM_CODE_ERROR",payload:{error:n}})}))}:function(e,n){e({type:"RESET"})}},setScannerActive:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function(n,t){var r=e?null:t().qr_scanner.most_recent_code;n({type:"SET_SCANNER_ACTIVE",payload:{scanner_active:e,most_recent_code:r}})}},resetScanner:u},v=Object(s.b)((function(e){return e.qr_scanner}),S)((function(e){var n=c.a.useState({scanMode:!0}),t=Object(_.a)(n,2),r=t[0],o=t[1],a=e.most_recent_code;return c.a.useEffect((function(){a&&e.setScannerActive(!1)}),[a]),console.log(e.most_recent_code),c.a.createElement("div",{className:"App"},c.a.createElement(E,{most_recent_code:e.most_recent_code,qr_code_fetched:e.qr_code_fetched,qr_code_fetch_error:e.qr_code_fetch_error,confirmed_qr_code:e.confirmed_qr_code,error_with_confirmation:e.error_with_confirmation,resetScanner:e.resetScanner,confirmQrCode:e.confirmQrCode}),c.a.createElement("button",{onClick:function(){var e=r.scanMode;o(Object(i.a)({},r,{scanMode:!e}))}},r.scanMode?"Switch To Manual Input":"Switch to Scanner Mode"),r.scanMode?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"qr-content"},e.scanner_active&&c.a.createElement(d.a,{className:"qr-scanner",delay:1e3,onError:function(e){console.error(e)},onScan:function(n){n&&e.scanQrCode(n)},style:{width:"100%"}})||c.a.createElement("p",null," Begin Scanning Below..."),e.most_recent_code&&e.confirmed_qr_code&&c.a.createElement("h2",{className:"registration-success"},"Successfully registered!"),e.loading&&c.a.createElement("p",null,"Loading..."),e.qr_code_fetch_error&&c.a.createElement("p",null,"There was an error scanning the QR code.. ",e.qr_code_fetch_error.message)),c.a.createElement("button",{onClick:function(){e.setScannerActive(!e.scanner_active)}},e.most_recent_code?"Scan Again":e.scanner_active?"Stop Scanning":"Start Scanning")):c.a.createElement("p",null," manual entry mode todo: "))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var p=t(5),C=t(16),R={scanner_active:!0,fetching_qr_code:!1,qr_code_fetch_error:null,most_recent_code:null,qr_code_fetched:!1,confirming_qr_code:!1,error_with_confirmation:null,confirmed_qr_code:!1},g=Object(p.c)({qr_scanner:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"RESET":return Object(i.a)({},e,{},R);case"SET_SCANNER_ACTIVE":return Object(i.a)({},e,{},n.payload);case"QR_SCANNER_START":return Object(i.a)({},e,{fetching_qr_code:!0,scanner_active:!1});case"QR_SCANNER_SUCCESS":return Object(i.a)({},e,{},R,{scanner_active:!1,qr_code_fetched:!0,fetching_qr_code:!1,most_recent_code:n.payload.value});case"QR_SCANNER_ERROR":return Object(i.a)({},e,{scanner_active:!1,qr_code_fetched:!1,fetching_qr_code:!1,qr_code_fetch_error:n.payload.error});case"CONFIRM_CODE_START":return Object(i.a)({},e,{confirming_qr_code:!0});case"CONFIRM_CODE_SUCCESS":return Object(i.a)({},e,{scanner_active:!1,confirmed_qr_code:!0});case"CONFIRM_CODE_ERROR":return Object(i.a)({},e,{error_with_confirmation:n.payload.error});default:return e}}}),N=Object(p.d)(g,Object(p.a)(C.a));a.a.render(c.a.createElement(s.a,{store:N},c.a.createElement(v,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[18,1,2]]]);
//# sourceMappingURL=main.3ea4af52.chunk.js.map