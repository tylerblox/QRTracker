(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{33:function(e,n,t){e.exports=t(53)},38:function(e,n,t){},47:function(e,n,t){},53:function(e,n,t){"use strict";t.r(n);var r=t(0),c=t.n(r),a=t(18),o=t.n(a),l=(t(38),t(22)),i=t(3),s=t(4),u=t(17),m=t(20),_=t(30),d=t.n(_);function f(){return function(e,n){e({type:"RESET"})}}function E(e){var n=null;if(document.cookie&&""!==document.cookie)for(var t=document.cookie.split(";"),r=0;r<t.length;r++){var c=t[r].trim();if(c.substring(0,e.length+1)===e+"="){n=decodeURIComponent(c.substring(e.length+1));break}}return n}var h=function(){return{type:"QR_SCANNER_START"}},v=function(e){return{type:"QR_SCANNER_ERROR",payload:{error:e}}};var p=function(){return{type:"CONFIRM_CODE_START"}};var S=function(){return{type:"FETCH_EVENTS_START"}},g=function(e){return{type:"FETCH_EVENTS_SUCCESS",payload:{events:e}}},C=function(e){return{type:"FETCH_EVENTS_ERROR",payload:{error:e}}};t(47);var R=t(14),b=t(12),O=function(e){return c.a.createElement("div",{className:"confirm-event-modal"},c.a.createElement("div",{className:"confirm-event-content"},e.error_with_confirmation&&c.a.createElement("p",{className:"error-text"},"Error in confirming event.  Please try again, or ",c.a.createElement("span",{onClick:e.resetScanner},"Scan a new Code")),c.a.createElement("div",{className:"confirm-event-content--topic"},"Confirm this Event"),c.a.createElement("div",{className:"confirm-event-content--event"},c.a.createElement("h1",{className:"confirm-event-content--event--name"},e.most_recent_code.event.name),c.a.createElement("ul",null,c.a.createElement("li",null,e.most_recent_code.event.date),c.a.createElement("li",null,e.most_recent_code.event.location.name)))),c.a.createElement("div",{className:"confirmation-buttons"},c.a.createElement("button",{className:"button--primary",onClick:function(){e.confirmQrCode(!0,{event_promoter:e.most_recent_code.id})}},c.a.createElement(R.a,{icon:b.c,size:"4x"})),c.a.createElement("button",{className:"button--secondary",onClick:function(){e.confirmQrCode(!1,{})}},c.a.createElement(R.a,{icon:b.d,size:"4x"}))))};var N={scanQrCode:function(e){return function(n,t){n(h),fetch("https://"+e).then((function(e){return e.ok||n(v(e)),e.json()})).then((function(e){return n({type:"QR_SCANNER_SUCCESS",payload:{value:e}})})).catch((function(e){return n(v(e))}))}},confirmQrCode:function(e,n){return e?function(e,t){e(p),fetch("https://qr-tickets.herokuapp.com/api/event_register/",{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json","X-CSRFToken":E("csrftoken")},redirect:"follow",body:JSON.stringify(n)}).then((function(e){if(!e.ok)throw"whoops";return e.json()})).then((function(n){return e({type:"CONFIRM_CODE_SUCCESS",payload:{value:n}})})).catch((function(n){return e({type:"CONFIRM_CODE_ERROR",payload:{error:n}})}))}:function(e,n){e({type:"RESET"})}},setScannerActive:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function(n,t){var r=e?null:t().qr_scanner.most_recent_code;n({type:"SET_SCANNER_ACTIVE",payload:{scanner_active:e,most_recent_code:r}})}},resetScanner:f},y=Object(m.b)((function(e){return e.qr_scanner}),N)((function(e){var n=c.a.useState({scanMode:!0}),t=Object(u.a)(n,2),r=t[0],a=t[1],o=e.most_recent_code;c.a.useEffect((function(){o&&e.setScannerActive(!1)}),[o]);var l=function(n){n&&e.scanQrCode(n)},i=function(e){console.log("DO SOME THING WITH THIS ERROR"),console.error(e)},m=e.most_recent_code&&e.qr_code_fetched&&!e.qr_code_fetch_error&&!e.confirmed_qr_code,_=c.a.useCallback(function(){switch(console.log(e),!0){case!!e.qr_code_fetch_error:return c.a.createElement("p",null,"There was an error scanning the QR code.. ",e.qr_code_fetch_error);case e.most_recent_code&&e.confirmed_qr_code:return c.a.createElement("h2",{className:"registration-success"},"Successfully registered!");case e.scanner_active:return c.a.createElement(d.a,{className:"qr-scanner",delay:1e3,onError:i,onScan:l});default:return c.a.createElement(c.a.Fragment,null,c.a.createElement("p",null," Begin Scanning Below..."),c.a.createElement("div",{style:{position:"relative",height:"100%"}},c.a.createElement(R.a,{icon:b.a,size:"2x",className:"arrow-moving-down",style:{color:"#FFF",marginLeft:"auto",position:"absolute",marginRight:"auto",left:0,right:0}})))}}(),[e]);return c.a.createElement("div",{className:"App",style:{height:window.innerHeight}},m&&c.a.createElement(O,{most_recent_code:e.most_recent_code,confirmed_qr_code:e.confirmed_qr_code,error_with_confirmation:e.error_with_confirmation,resetScanner:e.resetScanner,confirmQrCode:e.confirmQrCode}),c.a.createElement("button",{onClick:function(){var n=r.scanMode;e.resetScanner(),a(Object(s.a)({},r,{scanMode:!n}))}},r.scanMode?"Switch To Manual Input":"Switch to Scanner Mode"),r.scanMode?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"qr-content"},_,e.loading&&c.a.createElement("p",null,"Loading...")),m?null:c.a.createElement("button",{className:e.most_recent_code?"scan-again":e.scanner_active?"scan-stop":"scan",onClick:function(){e.setScannerActive(!e.scanner_active)}},c.a.createElement(R.a,{icon:b.b,size:"2x"}))):c.a.createElement("p",null," manual entry mode todo: "))})),T={loading:!1,error:null,events:null},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"FETCH_EVENTS_START":return Object(s.a)({},e,{loading:!0,error:null});case"FETCH_EVENTS_SUCCESS":return Object(s.a)({},e,{loading:!1,error:null,events:n.payload.events});case"FETCH_EVENTS_ERROR":return Object(s.a)({},e,{loading:!1,error:n.payload.error});default:return e}};function q(e){var n=Object(r.useReducer)(w,T),t=Object(u.a)(n,2),a=t[0],o=t[1],l=Object(r.useState)(null),i=Object(u.a)(l,2),s=i[0],m=i[1];return Object(r.useEffect)((function(){!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(n){n(S),fetch("https://qr-tickets.herokuapp.com"+"/api/events/".concat(e?"?":"").concat(e),{mode:"cors",cache:"no-cache",credentials:"same-origin",redirect:"follow"}).then((function(e){if(!e.ok)throw"whoops";return e.json()})).then((function(e){return n(g(e))})).catch((function(e){return n(C(e))}))}}()(o)}),[]),a.loading?"Loading":a.events?c.a.createElement(c.a.Fragment,null,a.events.map((function(e,n){return c.a.createElement("button",{key:e.id,name:e.name,onClick:function(){return m(e)}},e.name)})),s?c.a.createElement("table",{style:{width:"100%",textAlign:"center"}},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,"Promoter"),c.a.createElement("th",null,"Registration Count"))),c.a.createElement("tbody",null,s.event_promoters.map((function(e){return c.a.createElement("tr",null,c.a.createElement("td",null,e.promoter_name),c.a.createElement("td",null,e.registration_count))})))):null):a.error?"error":null}function j(){var e=Object(i.g)(),n=e.path;e.url;return console.log(n),c.a.createElement(i.d,null,c.a.createElement(i.b,{path:"".concat(n,"/statistics/")},c.a.createElement(q,null)))}var k=function(e){return c.a.createElement(l.a,null,c.a.createElement(i.d,null,c.a.createElement(i.b,{path:"/admin"},c.a.createElement(j,null)),c.a.createElement(i.b,{path:"/"},c.a.createElement(y,null)),c.a.createElement(i.a,{to:"/"})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var A=t(11),F=t(32),I={scanner_active:!0,fetching_qr_code:!1,qr_code_fetch_error:null,most_recent_code:null,qr_code_fetched:!1,confirming_qr_code:!1,error_with_confirmation:null,confirmed_qr_code:!1},M=Object(A.c)({qr_scanner:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"RESET":return Object(s.a)({},e,{},I);case"SET_SCANNER_ACTIVE":return Object(s.a)({},e,{qr_code_fetch_error:null},n.payload);case"QR_SCANNER_START":return Object(s.a)({},e,{fetching_qr_code:!0,scanner_active:!1});case"QR_SCANNER_SUCCESS":return Object(s.a)({},e,{},I,{scanner_active:!1,qr_code_fetched:!0,fetching_qr_code:!1,most_recent_code:n.payload.value});case"QR_SCANNER_ERROR":return Object(s.a)({},e,{scanner_active:!1,qr_code_fetched:!1,fetching_qr_code:!1,qr_code_fetch_error:n.payload.error.message});case"CONFIRM_CODE_START":return Object(s.a)({},e,{confirming_qr_code:!0});case"CONFIRM_CODE_SUCCESS":return Object(s.a)({},e,{scanner_active:!1,confirmed_qr_code:!0});case"CONFIRM_CODE_ERROR":return Object(s.a)({},e,{error_with_confirmation:n.payload.error});default:return e}}}),Q=Object(A.d)(M,Object(A.a)(F.a));o.a.render(c.a.createElement(m.a,{store:Q},c.a.createElement(k,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[33,1,2]]]);
//# sourceMappingURL=main.0bccd2bb.chunk.js.map